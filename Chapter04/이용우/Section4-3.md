# Chapter 4 DataBase(λ°μ΄ν„°λ² μ΄μ¤)

# Section 4.3 νΈλμ­μ…κ³Ό λ¬΄κ²°μ„±

## Transaction(νΈλμ­μ…)

> π’΅ Transaction(νΈλμ­μ…)μ€ λ°μ΄ν„°λ² μ΄μ¤μ—μ„ ν•λ‚μ λ…Όλ¦¬μ μΈ κΈ°λ¥μ„ μν–‰ν•κΈ° μ„ν• μ‘μ—…μ λ‹¨μ„λ¥Ό λ»ν•κ³ , μ—¬λ¬κ°μ μΏΌλ¦¬λ“¤μ„ ν•λ‚λ΅ λ¬¶μ–΄ μ‚¬μ©ν•λ” κ²ƒμ„ λ»ν•©λ‹λ‹¤.
>

## π“ μ›μμ„±(Atomicity)

> π’΅ μ›μμ„±(Atomicity)μ€ νΈλμ­μ…κ³Ό κ΄€λ ¨λ μΌμ΄ λ¨λ‘ μν–‰λκ±°λ‚, μ•„λ‹λ©΄ μ „ν€ μν–‰λμ§€ μ•μ•„μ•Ό ν•λ‹¤λ” κ²ƒμ„ μλ―Έν•©λ‹λ‹¤.
>
νΈλμ­μ…μ κΈ°λ³Έμ μΈ κ°λ…μ€ μ›μμ„±μ—μ„ λ‚νƒ€λ‚κ² λμ—μµλ‹λ‹¤.

### COMMITκ³Ό ROLLBACK

> π’΅ COMMIT(μ»¤λ°‹)μ€ νΈλμ­μ…μ—μ„ μν–‰ν• μ—¬λ¬κ°€μ§€μ μΏΌλ¦¬κ°€ μ„±κ³µμ μΌλ΅ μ²λ¦¬λμ—λ‹¤κ³  ν™•μ •ν•λ” λ…λ Ήμ–΄μ…λ‹λ‹¤.
> μ»¤λ°‹μ€ νΈλμ­μ… λ‹¨μ„λ΅ μν–‰λλ©°, μ‘μ—…λ λ‚΄μ©μ΄ λ°μ΄ν„°λ² μ΄μ¤μ— μκµ¬μ μΌλ΅ λ°μλλ” κ²ƒμ„ λ»ν•©λ‹λ‹¤.
>


> π’΅ ROLLBACK(λ΅¤λ°±)μ€ νΈλμ­μ…μ—μ„ μν–‰ν• μ—¬λ¬κ°€μ§€μ μΏΌλ¦¬λ¥Ό λ°μ΄ν„°λ² μ΄μ¤μ— λ°μν•μ§€ μ•κ³ , νΈλμ­μ…μ΄ μ‹μ‘λ μƒνƒλ΅ λλλ¦¬λ” κ²ƒ(μ·¨μ†)μ„ λ»ν•©λ‹λ‹¤.
>
μ»¤λ°‹κ³Ό λ΅¤λ°±μ΄λΌλ” κ°λ…μΌλ΅ μΈν•΄, μ›μμ„±μ΄λΌλ” νΉμ§•μ„ μ§€ν‚¬ μ μκ² λκ³ , λ°μ΄ν„°μ λ¬΄κ²°μ„±μ΄ λ³΄μ¥λκ² λ©λ‹λ‹¤.

### νΈλμ­μ…μ μ „ν

νΈλμ­μ…μ€ ν•λ‚μ μ»¤λ„¥μ…(Connection)λ‹¨μ„λ΅ μ‘μ—…μ„ μν–‰ν•κΈ° λ•λ¬Έμ—, λ°μ΄ν„°λ² μ΄μ¤μ™€ μ—°κ²°λ μ»¤λ„¥μ… κ°μ²΄λ¥Ό μ „λ‹¬ν•μ—¬ μ‘μ—…μ„ μν–‰ν•©λ‹λ‹¤.  
ν•μ§€λ§, λ§¤λ² **νΈλμ­μ… μ»¤λ„¥μ…**μ„ μƒμ„±ν•κ³ , μ‘μ—…μ„ μν–‰ν• ν›„μ— μ»¤λ„¥μ…μ„ λ‹«λ” κ²ƒμ€ λ§¤μ° λΉ„ν¨μ¨μ μΈ μ‘μ—…μ…λ‹λ‹¤.  
μ΄λ¬ν• μƒν™©μ„ ν•΄κ²°ν•κΈ° μ„ν•΄, μ¤ν”„λ§μ—μ„λ” **νΈλμ­μ…μ μ „ν**λ¥Ό μ§€μ›ν•©λ‹λ‹¤.

``` java
@Service
@Transactional(readOnly = true)
public class MemberService {
  private final MemberRepository memberRepositoryl
  
  public MemberService(MemberRepository memberRepository) {
    this.memberRepository = memberRepository;
  }
}
```

μ„μ™€ κ°™μ΄ μ¤ν”„λ§μ—μ„λ” `@Transactional` Annotationμ„ μ΄μ©ν•΄ μ—¬λ¬κ°μ μΏΌλ¦¬λ¥Ό ν•λ‚μ νΈλμ­μ…μΌλ΅ μ²λ¦¬ν•  μ μκ² λ©λ‹λ‹¤.

## π“ μΌκ΄€μ„±(Consistency)

> π’΅ μΌκ΄€μ„±(Consistency)μ€ νΈλμ­μ…μ΄ μ„±κ³µμ μΌλ΅ μ™„λ£λλ©΄, λ°μ΄ν„°λ² μ΄μ¤λ” μΌκ΄€μ„± μλ” μƒνƒλ΅ μ μ§€λμ–΄μ•Ό ν•λ‹¤λ” κ²ƒμ„ μλ―Έν•©λ‹λ‹¤.
>
λ§μ•½ λ°μ΄ν„°λ² μ΄μ¤ μ‘μ—…μ„ μ²λ¦¬ν•λ μ¤‘ μ¤λ¥κ°€ λ°μƒν•κ² λμ–΄ μƒκ°μ§€λ„ λ»ν• λ°μ΄ν„°κ°€ λ°μ΄ν„°λ² μ΄μ¤μ— λ°μλμ–΄ μμ„ κ²½μ°, μ›ν•λ” μƒνƒλ΅ λ°μ΄ν„°λ¥Ό λ³µκµ¬ν•κΈ° μ„ν•΄ λ”μ± λ§μ€ μΌμ„ μν–‰ν•΄μ•Όν•  μλ„ μκΈ° λ•λ¬Έμ…λ‹λ‹¤.

## π“ κ²©λ¦¬μ„±(Isolation)

> π’΅ κ²©λ¦¬μ„±(Isolation)μ€ νΈλμ­μ…λ“¤μ΄ λ™μ‹μ— μ‹¤ν–‰λκ³  μμ„ λ•, κ°κ°μ νΈλμ­μ…μ€ μ„λ΅ κ°„μ„­ μ—†μ΄ λ…λ¦½μ μΌλ΅ μν–‰λμ–΄μ•Ό ν•λ‹¤λ” κ²ƒμ„ μλ―Έν•©λ‹λ‹¤.
>

### κ²©λ¦¬ μμ¤€(Isolation Level)

> π’΅ κ²©λ¦¬ μμ¤€(Isolation Level)μ€ λ™μ‹μ„±κ³Ό κ²©λ¦¬μ„±μ„ μ–΄λ μ •λ„λ΅ λ³΄μ¥ν•  κ²ƒμΈμ§€λ¥Ό κ²°μ •ν•λ” μμ¤€μ„ μλ―Έν•©λ‹λ‹¤.
>

κ²©λ¦¬ μμ¤€μ€ λ™μ‹μ„±κ³Ό κ²©λ¦¬μ„± μ¤‘ μ–΄λ κ²ƒμ„ λ” μ¤‘μ”μ‹ ν•  κ²ƒμΈμ§€μ— λ”°λΌ λ‹¤λ¥΄κ² μ„¤μ •ν•  μ μμµλ‹λ‹¤.

- `READ_UNCOMMITTED`(μ½κΈ° λ―Έμ»¤λ°‹)
- `READ_COMMITTED`(μ½κΈ° μ»¤λ°‹)
- `REPEATABLE_READ`(λ°λ³µ μ½κΈ°)
- `SERIALIZABLE`(μ§λ ¬ν™”)

## π“ μ§€μ†μ„±(Durability)

> π’΅ μ§€μ†μ„±(Durability)μ€ νΈλμ­μ…μ΄ μ„±κ³µμ μΌλ΅ μ™„λ£λλ©΄, κ·Έ κ²°κ³Όλ” λ°μ΄ν„°λ² μ΄μ¤μ— μκµ¬μ μΌλ΅ λ°μλμ–΄μ•Ό ν•λ‹¤λ” κ²ƒμ„ μλ―Έν•©λ‹λ‹¤.
>
λ§μ•½, λ°μ΄ν„°λ² μ΄μ¤μ— μ¥μ• κ°€ λ°μƒν•λ”λΌλ„ μ›λ μƒνƒλ΅ λ³µκµ¬ν•κΈ° μ„ν•΄ νλ³µ κΈ°λ¥μ„ μ§€μ›ν•΄μ•Όν•λ‹¤λ” κ²ƒμ„ λ»ν•λ©°, μ΄λ¥Ό μ„ν•΄ λ°μ΄ν„°λ² μ΄μ¤λ” μ²΄ν¬μ„¬κ³Ό λ΅¤λ°±κ³Ό κ°™μ€ κΈ°λ¥μ„ μ§€μ›ν•κ²λ©λ‹λ‹¤.

## π“ λ¬΄κ²°μ„±(Integrity)

> π’΅ λ¬΄κ²°μ„±(Integrity)μ€ λ°μ΄ν„°μ μ •ν™•μ„± μΌκ΄€μ„±, μ ν¨μ„±μ„ μ μ§€ν•λ” κ²ƒμ„ λ»ν•λ©°, λ¬΄κ²°μ„±μ΄ μ μ§€λμ–΄μ•Ό λ°μ΄ν„°λ² μ΄μ¤μ— μ €μ¥λ λ°μ΄ν„°λ¥Ό μ‹ λΆ°ν•  μ μκ² λ  κ²ƒμ…λ‹λ‹¤.
>

- κ°μ²΄ λ¬΄κ²°μ„±(Entity Integrity)
    - κ°μ²΄ λ¬΄κ²°μ„±μ€ ν…μ΄λΈ”μ κΈ°λ³Έν‚¤(Primary Key)λ” NULL κ°’μ„ κ°€μ§ μ μ—†μΌλ©°, μ¤‘λ³µλ κ°’μ„ κ°€μ§ μ μ—†λ‹¤λ” κ²ƒμ„ μλ―Έν•©λ‹λ‹¤.
- μ°Έμ΅° λ¬΄κ²°μ„±(Referential Integrity)
    - μ°Έμ΅° λ¬΄κ²°μ„±μ€ μ™Έλν‚¤(Foreign Key)λ” NULL κ°’μ„ κ°€μ§ μ μ—†μΌλ©°, μ°Έμ΅°ν•λ” ν…μ΄λΈ”μ κΈ°λ³Έν‚¤(Primary Key) κ°’μ΄ μ΅΄μ¬ν•΄μ•Ό ν•λ‹¤λ” κ²ƒμ„ μλ―Έν•©λ‹λ‹¤.
- κ³ μ  λ¬΄κ²°μ„±(Unique Integrity)
    - κ³ μ  λ¬΄κ²°μ„±μ€ ν…μ΄λΈ”μ μ»¬λΌμ΄ κ³ μ ν• κ°’μ„ κ°€μ§€λ„λ΅ μ„¤μ •ν• κ²½μ°, ν•΄λ‹Ήν•λ” μ»¬λΌμ€ λ¨λ‘ κ³ μ ν• κ°’μ„ κ°€μ Έμ•Όν•λ‹¤λ” κ²ƒμ„ μλ―Έν•©λ‹λ‹¤.
- NULL λ¬΄κ²°μ„±(Null Integrity)
    - NULL λ¬΄κ²°μ„±μ€ ν…μ΄λΈ”μ μ»¬λΌμ΄ NULLμ„ ν—μ©ν•μ§€ μ•λ”λ‹¤λ” μ΅°κ±΄μ΄ μ£Όμ–΄μ§„ κ²½μ°, ν•΄λ‹Ήν•λ” μ»¬λΌμ€ NULL κ°’μ„ κ°€μ§ μ μ—†λ‹¤λ” κ²ƒμ„ μλ―Έν•©λ‹λ‹¤. 
